(this["webpackJsonpbus-ticketing"]=this["webpackJsonpbus-ticketing"]||[]).push([[0],{33:function(module,__webpack_exports__,__webpack_require__){"use strict";var C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(34),C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(5),C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6),C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2),C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(8),C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(7),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__),axios__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(12),axios__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_7__),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(0),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__),SelectSeats=function(_React$Component){Object(C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__.a)(SelectSeats,_React$Component);var _super=Object(C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_5__.a)(SelectSeats);function SelectSeats(props){var _this;return Object(C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__.a)(this,SelectSeats),_this=_super.call(this,props),_this.handleChange=function(e,num){var createNew=!0;if(_this.state.forms.forEach((function(form,index){if(form.seatNumber===num){var formsCopy=_this.state.forms;eval("formsCopy[index]."+e.target.name+"=String(e.target.value)"),_this.setState({forms:formsCopy}),console.log("Updated: ",_this.state.forms),createNew=!1}})),!0===createNew){var form={seatNumber:num,name:"name"===e.target.name?e.target.value:"",gender:"gender"===e.target.name?e.target.value:""},formsCopy=_this.state.forms;formsCopy.push(form),_this.setState({forms:formsCopy}),console.log("newFrom: ",_this.state.forms)}var formsCopyy=_this.state.forms;_this.state.forms.forEach((function(e,t){var s=!0;_this.state.selectedSeats.forEach((function(t,n){e.seatNumber===t&&(s=!1)})),s&&formsCopyy.splice(t,1)})),_this.setState({forms:formsCopyy})},_this.MyBusContainer=_this.MyBusContainer.bind(Object(C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__.a)(_this)),_this.MySummaryContainer=_this.MySummaryContainer.bind(Object(C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__.a)(_this)),_this.createSeats=_this.createSeats.bind(Object(C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__.a)(_this)),_this.handleSelectedSeats=_this.handleSelectedSeats.bind(Object(C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__.a)(_this)),_this.handleChange=_this.handleChange.bind(Object(C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__.a)(_this)),_this.handleSubmit=_this.handleSubmit.bind(Object(C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_3__.a)(_this)),_this.state={userId:window.sessionStorage.getItem("userId"),busId:void 0===_this.props.location.bus?window.sessionStorage.getItem("busId"):_this.props.location.bus.id,date:void 0===_this.props.location.bus?window.sessionStorage.getItem("date"):_this.props.location.bus.date,getBusDetails:!1,busDetails:[],selectedSeats:[],unavailableSeats:[],reason:"",forms:[{seatNumber:0,name:"",gender:""}]},_this}return Object(C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__.a)(SelectSeats,[{key:"handleSubmit",value:function(){var e=this;document.getElementById("submitForm").style.backgroundColor="grey",document.getElementById("submitForm").disabled=!0;var t=!0,s=!1,n=!0;console.log(this.state.forms),this.state.forms.forEach((function(a){""!==a.name&&""!==a.gender||(t=!1,0===e.state.selectedSeats.length?e.setState({reason:"You Should Select Atleast One Seat Before Making Payment"}):e.setState({reason:"Kindly Fill Out All The Details Before Making Payment"})),e.state.selectedSeats.forEach((function(e){a.seatNumber===e&&(s=!0)})),n=!!(n&&s&&t)})),this.state.forms.length!==this.state.selectedSeats.length&&(n=!1),JSON.parse(window.sessionStorage.getItem("loggedIn"))&&this.state.getBusDetails||(n=!1),console.log("valid: ",n),n&&(window.sessionStorage.setItem("forms",JSON.stringify(this.state.forms)),window.sessionStorage.setItem("seatNumber",JSON.stringify(this.state.selectedSeats)),document.getElementById("submitForm").style.backgroundColor="green",document.getElementById("submitForm").disabled=!1,window.location.replace("http://localhost:3000/payment")),document.getElementById("submitForm").style.backgroundColor="green",document.getElementById("submitForm").disabled=!1}},{key:"componentDidMount",value:function(){var e=this;void 0!==this.props.location.bus&&(window.sessionStorage.setItem("busId",this.props.location.bus.id),window.sessionStorage.setItem("date",this.props.location.bus.date));var t={busId:this.state.busId,date:this.state.date};axios__WEBPACK_IMPORTED_MODULE_7___default.a.post("http://localhost:5000/api/selectSeats/getBusDetails",t).then((function(t){Boolean(t.data.getBusDetails)?(e.setState({getBusDetails:!0}),e.setState({busDetails:t.data.busDetails[0]}),e.setState({unavailableSeats:t.data.unavailableSeats})):e.setState({reason:t.data.reason})})).catch((function(t){e.setState({reason:"Axios error"}),console.log(t)})).then((function(){setTimeout((function(){for(var t=e.state.busDetails.totalSeats,s=1;s<=t;s+=1){e.state.unavailableSeats.indexOf(s)>-1&&(document.getElementById(String(s)).style.backgroundColor="#555",document.getElementById(String(s)).disabled=!0)}console.log(e.state)}),10)}))}},{key:"createSeats",value:function(){for(var e=[],t=this.state.busDetails.totalSeats,s=1;s<=t;s+=1)e=[].concat(Object(C_Users_Ganesan_Documents_GitHub_mfrp_frontend_bus_ticketing_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__.a)(e),[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("button",{className:"seats",id:String(s),onClick:this.handleSelectedSeats,children:["Seat ",s]})]);return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.Fragment,{children:[" ",e," "]})}},{key:"handleSelectedSeats",value:function(e){if(!JSON.parse(window.sessionStorage.getItem("loggedIn")))return this.setState({reason:"Kindly Login Before Selecting Seats"}),1;this.setState({reason:""}),console.log(e.target.name);var t=this.state.selectedSeats,s=Number(e.target.id),n=t.indexOf(s);n>-1?t.splice(n,1):t.push(s),this.setState({selectedSeats:t}),console.log(t),console.log(this.state.selectedSeats);for(var a=1;a<=40;a+=1){var r=t.indexOf(a)>-1;this.state.unavailableSeats.indexOf(a)>-1||(document.getElementById(String(a)).style.backgroundColor=r?"crimson":"green")}}},{key:"MyBusContainer",value:function(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("div",{id:"busContainer",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("div",{id:"bus",children:this.createSeats()})})}},{key:"MySummaryContainer",value:function(){var e=this;return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("div",{id:"summaryContainer",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("div",{id:"summary",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("h2",{children:"Booking Summary"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("section",{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:"From"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:this.state.busDetails.from})]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("section",{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:"To"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:this.state.busDetails.to})]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("section",{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:"Date"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:this.state.date})]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("section",{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:"Travel Time"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:this.state.busDetails.travelTime})]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("section",{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:"Bus Type"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("span",{children:[this.state.busDetails.busType,": ",this.state.busDetails.totalSeats]})]}),this.state.selectedSeats.map((function(t){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("section",{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:"Seat No"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:t})]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("form",{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("input",{type:"text",onChange:function(s){return e.handleChange(s,t)},name:"name",placeholder:"Name"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("label",{htmlFor:"selectSeatsR"+t,children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("input",{type:"radio",onChange:function(s){return e.handleChange(s,t)},value:"male",id:"selectSeatsR"+t,name:"gender"}),"Male"]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("label",{htmlFor:t+"selectSeatsR"+t,children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("input",{type:"radio",onChange:function(s){return e.handleChange(s,t)},value:"female",id:t+"selectSeatsR"+t,name:"gender"}),"Female"]})]})]})})),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("section",{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:"Total Seats"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:this.state.selectedSeats.length})]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("section",{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:"Fare"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("span",{children:["Rs.",this.state.busDetails.busFare*this.state.selectedSeats.length]})]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("section",{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:"Service Tax"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("span",{children:["Rs.",this.state.busDetails.busFare*this.state.selectedSeats.length*.1]})]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("section",{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{children:"Service Charges"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("span",{children:["Rs.",Math.floor(this.state.busDetails.busFare*this.state.selectedSeats.length*1.1)]}),window.sessionStorage.setItem("totalAmount",Math.floor(this.state.busDetails.busFare*this.state.selectedSeats.length*1.1))]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("button",{onClick:this.handleSubmit,id:"submitForm",children:"Continue to Payment"})]})})}},{key:"render",value:function(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("div",{id:"selectSeatsContainer",children:[this.MyBusContainer(),this.MySummaryContainer()]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("div",{id:"errorBox",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("p",{children:this.state.reason})})]})}}]),SelectSeats}(react__WEBPACK_IMPORTED_MODULE_6___default.a.Component);__webpack_exports__.a=SelectSeats},39:function(e,t,s){},40:function(e,t,s){},65:function(e,t,s){"use strict";s.r(t);var n=s(1),a=s.n(n),r=s(31),i=s.n(r),_=(s(39),s(40),s(13)),o=s(15),c=s(5),l=s(6),d=s(2),u=s(8),h=s(7),b=s(3),j=s(12),m=s.n(j),O=s(0),p=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(e){var n;return Object(c.a)(this,s),(n=t.call(this,e)).handleChange=n.handleChange.bind(Object(d.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(d.a)(n)),n.state={name:"",email:"",mobileNumber:"",password:"",dateOfBirth:"",gender:"",reason:"",signup:!1},n}return Object(l.a)(s,[{key:"componentDidMount",value:function(){this.setState({signup:JSON.parse(window.sessionStorage.getItem("signup"))})}},{key:"handleChange",value:function(e){this.setState(Object(o.a)({},e.target.name,e.target.value))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),document.getElementById("signupFormButton").disabled=!0;var s=document.getElementById("signupFormButton").style.backgroundColor;document.getElementById("signupFormButton").style.backgroundColor="grey";var n={name:this.state.name,email:this.state.email,mobileNumber:this.state.mobileNumber,password:this.state.password,dateOfBirth:this.state.dateOfBirth,gender:this.state.gender};console.log(n),m.a.post("http://localhost:5000/api/signup",n).then((function(e){t.setState({reason:e.data.reason}),t.setState({signup:e.data.signup}),window.sessionStorage.setItem("signup",e.data.signup),e.data.signup&&setTimeout((function(){window.history.back()}),1e3)})).catch((function(e){t.setState({reason:"error sending data"})})).then((function(){t.state.signup||(document.getElementById("signupFormButton").disabled=!1,document.getElementById("signupFormButton").style.backgroundColor=s)}))}},{key:"render",value:function(){return this.state.signup?Object(O.jsx)("form",{id:"signUpForm",onSubmit:this.handleSubmit,children:Object(O.jsx)("h2",{style:{color:"green"},children:"You have successfully created account! Please login to enjoy the services."})}):Object(O.jsxs)("form",{id:"signUpForm",onSubmit:this.handleSubmit,children:[Object(O.jsx)("h2",{children:"New user? Signup to enjoy services"}),Object(O.jsx)("input",{type:"name",name:"name",onChange:this.handleChange,placeholder:"Name"}),Object(O.jsx)("input",{type:"email",name:"email",onChange:this.handleChange,placeholder:"Email Id"}),Object(O.jsx)("input",{type:"tel",name:"mobileNumber",onChange:this.handleChange,placeholder:"Mobile Number"}),Object(O.jsx)("input",{type:"password",name:"password",onChange:this.handleChange,placeholder:"Password"}),Object(O.jsx)("div",{children:"Date Of Birth:"}),Object(O.jsx)("input",{type:"date",name:"dateOfBirth",onChange:this.handleChange}),Object(O.jsxs)("div",{children:[Object(O.jsxs)("label",{htmlFor:"signUpR1",children:[Object(O.jsx)("input",{type:"radio",id:"signUpR1",name:"gender",value:"male",onChange:this.handleChange}),"Male",Object(O.jsx)("br",{})]}),Object(O.jsxs)("label",{htmlFor:"signUpR2",children:[Object(O.jsx)("input",{type:"radio",id:"signUpR2",name:"gender",value:"female",onChange:this.handleChange}),"Female"]})]}),Object(O.jsx)("button",{id:"signupFormButton",type:"submit",children:"Sign Up"}),Object(O.jsx)("h2",{style:{color:"red"},children:this.state.reason})]})}}]),s}(a.a.Component),g=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(e){var n;return Object(c.a)(this,s),(n=t.call(this,e)).state={busesArray:[],selectBus:!1,reason:""},n}return Object(l.a)(s,[{key:"componentDidMount",value:function(){var e=this;console.log(this.props),m.a.post("http://localhost:5000/api/selectBus",this.props).then((function(t){Boolean(t.data.selectBus)?(e.setState({busesArray:t.data.busesArray}),e.setState({selectBus:t.data.selectBus}),e.setState({reason:""}),console.log(e.state)):e.setState({reason:t.data.reason})})).catch((function(t){e.setState({reason:"Axios error"}),console.log(t)}))}},{key:"render",value:function(){var e=this;return Object(O.jsxs)("div",{id:"selectBusContainer",children:[Object(O.jsx)("p",{children:"Select Bus"}),Object(O.jsx)("div",{id:"selectBus",children:Object(O.jsxs)("table",{id:"selectBusTable",children:[Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Bus Type"}),Object(O.jsx)("th",{children:"Departure"}),Object(O.jsx)("th",{children:"Arrival"}),Object(O.jsx)("th",{children:"Travel Time"}),Object(O.jsx)("th",{children:"Date"}),Object(O.jsx)("th",{children:"Seats Available"}),Object(O.jsx)("th",{children:"Fare"}),Object(O.jsx)("th",{})]}),this.state.busesArray.map((function(t){return Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{children:t.busType}),Object(O.jsx)("td",{children:t.departure}),Object(O.jsx)("td",{children:t.arrival}),Object(O.jsx)("td",{children:t.travelTime}),Object(O.jsx)("td",{children:e.props.date}),Object(O.jsx)("td",{children:t.seatsAvailable}),Object(O.jsx)("td",{children:t.busFare}),Object(O.jsx)("td",{children:Object(O.jsx)(_.b,{to:{pathname:"/selectSeats",bus:{id:t._id,date:e.props.date}},children:Object(O.jsx)("button",{children:"View Seats"})})})]})}))]})})]})}}]),s}(a.a.Component),x=s(12).default,E=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(e){var n;return Object(c.a)(this,s),(n=t.call(this,e)).handleSubmit=n.handleSubmit.bind(Object(d.a)(n)),n.handleChange=n.handleChange.bind(Object(d.a)(n)),n.handleReset=n.handleReset.bind(Object(d.a)(n)),n.state={fromArray:[],toArray:[],planTrip:!1,reason:"",from:"",to:"",date:"",selectBus:!1},n}return Object(l.a)(s,[{key:"handleSubmit",value:function(e){e.preventDefault(),this.state.from&&this.state.to&&this.state.date?(this.setState({selectBus:!0}),this.setState({reason:""})):(this.setState({selectBus:!1}),this.setState({reason:"Please fill all the details"}))}},{key:"handleChange",value:function(e){this.setState(Object(o.a)({},e.target.name,e.target.value)),this.setState({selectBus:!1}),this.state.reason&&this.setState({reason:""})}},{key:"handleReset",value:function(e){this.setState({from:""}),this.setState({to:""}),this.setState({date:""}),this.setState({selectBus:!1})}},{key:"componentDidMount",value:function(){var e=this;x.get("http://localhost:5000/api/planTrip").then((function(t){Boolean(t.data.planTrip)?(e.setState({fromArray:t.data.from}),e.setState({toArray:t.data.to}),e.setState({planTrip:!0})):(e.setState({planTrip:!1}),e.setState({reason:t.data.reason}))})).catch((function(t){e.setState({planTrip:!1}),e.setState({reason:"axios error"})}))}},{key:"render",value:function(){var e=(new Date).getTime(),t=e+5184e5,s=new Date(e).toISOString().substr(0,10),n=new Date(t).toISOString().substr(0,10);return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("form",{onSubmit:this.handleSubmit,id:"planTripForm",action:"",children:[Object(O.jsx)("p",{children:"Plan Your Trip"}),Object(O.jsx)("div",{id:"planTrip",children:Object(O.jsxs)("table",{id:"planTripTable",children:[Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"From"}),Object(O.jsx)("th",{children:"To"}),Object(O.jsx)("th",{children:"Travel Date"}),Object(O.jsx)("th",{})]}),Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{children:Object(O.jsxs)("select",{name:"from",onChange:this.handleChange,children:[Object(O.jsx)("option",{selected:!0,value:"",children:" Select "}),this.state.fromArray.map((function(e){return Object(O.jsxs)("option",{value:e,children:[" ",e," "]})}))]})}),Object(O.jsx)("td",{children:Object(O.jsxs)("select",{name:"to",onChange:this.handleChange,children:[Object(O.jsx)("option",{selected:!0,value:"",children:" Select "}),this.state.toArray.map((function(e){return Object(O.jsxs)("option",{value:e,children:[" ",e," "]})}))]})}),Object(O.jsx)("td",{children:Object(O.jsx)("input",{name:"date",onChange:this.handleChange,type:"date",min:s,max:n})}),Object(O.jsx)("td",{children:Object(O.jsx)("button",{type:"submit",children:"Plan Trip"})})]})]})}),Object(O.jsx)("button",{onClick:this.handleReset,type:"reset",children:"Reset"}),Object(O.jsx)("br",{}),Object(O.jsx)("section",{id:"errorBox",children:Object(O.jsx)("div",{children:this.state.reason})})]}),this.state.selectBus?Object(O.jsx)(g,{from:this.state.from,to:this.state.to,date:this.state.date}):""]})}}]),s}(a.a.Component),f=s(33),S=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(e){var n;return Object(c.a)(this,s),(n=t.call(this,e)).handleChange=n.handleChange.bind(Object(d.a)(n)),n.validateForm=n.validateForm.bind(Object(d.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(d.a)(n)),n.state={transactionId:Math.floor(1e5*(Math.random()+1)),cardType:"",cardNumber:0,cardName:"",cvv:0,expiryDate:"",valid:{},error:{}},n}return Object(l.a)(s,[{key:"componentDidMount",value:function(){JSON.parse(window.sessionStorage.getItem("ticketsCreated"));var e=window.sessionStorage.getItem("busId"),t=window.sessionStorage.getItem("date");e&&t||(document.getElementById("submitForm").style.backgroundColor="grey",document.getElementById("submitForm").disabled=!0)}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var s=JSON.parse(window.sessionStorage.getItem("loggedIn")),n=JSON.parse(window.sessionStorage.getItem("ticketsCreated")),a=window.sessionStorage.getItem("busId"),r=window.sessionStorage.getItem("date");if(this.validateForm(e)&&s&&a&&r){console.log("Form Validation passed and loggedIn and tickets not yet created");var i={busId:window.sessionStorage.getItem("busId"),userId:window.sessionStorage.getItem("userId"),date:window.sessionStorage.getItem("date"),seatNumber:JSON.parse(window.sessionStorage.getItem("seatNumber")),forms:JSON.parse(window.sessionStorage.getItem("forms"))};console.log(i),document.getElementById("submitForm").style.backgroundColor="grey",document.getElementById("submitForm").disabled=!0,m.a.post("http://localhost:5000/api/payment/generateTickets",i).then((function(e){window.sessionStorage.setItem("ticketsCreated",!0),n=!0})).catch((function(e){t.setState({ticketsCreated:!1})})).then((function(){document.getElementById("submitForm").style.backgroundColor="green",document.getElementById("submitForm").disabled=!1,!1===n?t.setState({reason:"error creating tickets please try again"}):(document.getElementById("submitForm").style.backgroundColor="grey",document.getElementById("submitForm").disabled=!0,window.sessionStorage.setItem("ticketsCreated",!0),window.location.replace("http://localhost:3000/viewTickets"))}))}else console.log("Form Validation failed and/or login failed")}},{key:"handleChange",value:function(e){this.setState(Object(o.a)({},e.target.name,e.target.value)),this.validateForm(e)}},{key:"validateForm",value:function(e){var t=e.target.name,s=e.target.value,n=this.state.valid,a=this.state.error;switch(t){case"cardType":n[t]=Boolean(s),n[t]?a[t]="":a[t]="Please Select Any CardType";break;case"cardNumber":n[t]=Boolean(16===s.length&&s>0),n[t]?a[t]="":a[t]="Card Number Must Be 16 Digits";break;case"cardName":e.target.value=s.replaceAll(/[^a-zA-Z' ']/g,""),n[t]=Boolean(s),n[t]?a[t]="":a[t]="Please Fill Out This";break;case"cvv":n[t]=Boolean(3===s.length),n[t]?a[t]="":a[t]="CVV Number Must Be Of 3 Digits";break;case"expiryDate":n[t]=Boolean(s),n[t]?a[t]="":a[t]="Please Provide Date";break;case"payNow":n[t]=n.cardType&&n.cardNumber&&n.cardName&&n.cvv&&n.expiryDate}if(this.setState({valid:n}),this.setState({error:a}),"payNow"===t)return n[t];n[t]?(console.log("Green"),e.target.style.border="3px solid green"):(console.log("red"),e.target.style.border="3px solid red")}},{key:"render",value:function(){return Object(O.jsxs)("div",{id:"paymentFormContainer",children:[Object(O.jsxs)("div",{children:[Object(O.jsxs)("span",{children:["Amount Rs.",window.sessionStorage.getItem("totalAmount")]}),Object(O.jsxs)("span",{children:["Transaction ID:",this.state.transactionId]})]}),Object(O.jsxs)("form",{id:"paymentForm",onSubmit:this.handleSubmit,name:"payNow",action:"",children:[Object(O.jsxs)("section",{children:[Object(O.jsx)("span",{children:"Card Type"}),Object(O.jsxs)("label",{htmlFor:"PaymentFormR1",children:[Object(O.jsx)("input",{type:"radio",value:"visa",id:"PaymentFormR1",name:"cardType",required:!0,onChange:this.handleChange}),"Visa"]}),Object(O.jsxs)("label",{htmlFor:"PaymentFormR2",children:[Object(O.jsx)("input",{type:"radio",value:"masterCard",id:"PaymentFormR2",name:"cardType",required:!0,onChange:this.handleChange}),"MasterCard"]}),Object(O.jsx)("br",{}),Object(O.jsx)("div",{id:"errorBox",children:Object(O.jsx)("p",{children:this.state.error.cardType})})]}),Object(O.jsxs)("section",{children:[Object(O.jsx)("span",{children:"Card Number"}),Object(O.jsx)("input",{type:"number",name:"cardNumber",required:!0,onChange:this.handleChange}),Object(O.jsx)("br",{}),Object(O.jsx)("div",{id:"errorBox",children:Object(O.jsx)("p",{children:this.state.error.cardNumber})})]}),Object(O.jsxs)("section",{children:[Object(O.jsx)("span",{children:"Name on Card"}),Object(O.jsx)("input",{type:"text",name:"cardName",required:!0,onChange:this.handleChange}),Object(O.jsx)("br",{}),Object(O.jsx)("div",{id:"errorBox",children:Object(O.jsx)("p",{children:this.state.error.cardName})})]}),Object(O.jsxs)("section",{children:[Object(O.jsx)("span",{children:"CVV"}),Object(O.jsx)("input",{type:"number",name:"cvv",required:!0,onChange:this.handleChange}),Object(O.jsx)("br",{}),Object(O.jsx)("div",{id:"errorBox",children:Object(O.jsx)("p",{children:this.state.error.cvv})})]}),Object(O.jsxs)("section",{children:[Object(O.jsx)("span",{children:"Expiry Date"}),Object(O.jsx)("input",{type:"date",name:"expiryDate",required:!0,onChange:this.handleChange}),Object(O.jsx)("br",{}),Object(O.jsx)("div",{id:"errorBox",children:Object(O.jsx)("p",{children:this.state.error.expiryDate})})]}),Object(O.jsxs)("section",{children:[Object(O.jsx)("button",{id:"submitForm",type:"submit",children:"Pay Now"}),Object(O.jsx)("button",{type:"reset",children:"Cancel"})]})]})]})}}]),s}(a.a.Component),C=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(e){var n;return Object(c.a)(this,s),(n=t.call(this,e)).state={viewTickets:!1,ticketsArray:[],busesArray:[]},n}return Object(l.a)(s,[{key:"componentDidMount",value:function(){var e=this,t={userId:window.sessionStorage.getItem("userId")};console.log(t),m.a.post("http://localhost:5000/api/viewTickets",t).then((function(t){Boolean(t.data.viewTickets)?(e.setState({busesArray:t.data.busesArray}),e.setState({ticketsArray:t.data.ticketsArray}),e.setState({viewTickets:t.data.viewTickets}),e.setState({reason:""})):e.setState({reason:t.data.reason})})).catch((function(t){e.setState({reason:"Axios error"})}))}},{key:"render",value:function(){var e=this.state.busesArray,t=this.state.ticketsArray;return e.length&&t.length?(console.log(e),console.log(t),Object(O.jsx)("div",{id:"viewTicketsContainer",children:Object(O.jsx)("div",{id:"viewTickets",children:this.state.ticketsArray.map((function(t,s){return Object(O.jsxs)("div",{children:[Object(O.jsxs)("p",{children:["Ticket Id : ",t._id]}),Object(O.jsxs)("p",{children:["Bus Id : ",e[s]._id]}),Object(O.jsxs)("table",{children:[Object(O.jsx)("h1",{children:"-----GREEN BUS TRAVELS-----"}),Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"From"}),Object(O.jsx)("td",{children:e[s].from})]}),Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"To"}),Object(O.jsx)("td",{children:e[s].to})]}),Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Date"}),Object(O.jsx)("td",{children:t.travelDate})]}),Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Departure Time"}),Object(O.jsx)("td",{children:e[s].departure})]})]}),Object(O.jsx)("hr",{}),Object(O.jsxs)("table",{children:[Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"SeatNo"}),Object(O.jsx)("th",{children:"Name"}),Object(O.jsx)("th",{children:"Gender"}),Object(O.jsx)("th",{children:"Fare"}),Object(O.jsx)("th",{children:"Service Tax"}),Object(O.jsx)("th",{children:"Amount"})]}),t.forms.map((function(t){return Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{children:t.seatNumber}),Object(O.jsx)("td",{children:t.name}),Object(O.jsx)("td",{children:t.gender}),Object(O.jsxs)("td",{children:["Rs.",e[s].busFare]}),Object(O.jsxs)("td",{children:["Rs.",Math.floor(.1*e[s].busFare)]}),Object(O.jsxs)("td",{children:["Rs.",Math.floor(1.1*e[s].busFare)]})]})}))]}),Object(O.jsx)("hr",{}),Object(O.jsxs)("h2",{children:["Total Amount : Rs.",Math.floor(1.1*e[s].busFare)*t.forms.length]})]})}))})})):""}}]),s}(a.a.Component),D=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(e){return Object(c.a)(this,s),t.call(this,e)}return Object(l.a)(s,[{key:"render",value:function(){return Object(O.jsx)("div",{id:"footer",children:Object(O.jsx)("hr",{})})}}]),s}(a.a.Component),y=s(12).default,I=function(e){Object(u.a)(s,e);var t=Object(h.a)(s);function s(e){var n;return Object(c.a)(this,s),(n=t.call(this,e)).Header=n.Header.bind(Object(d.a)(n)),n.Login=n.Login.bind(Object(d.a)(n)),n.handleChangeLogin=n.handleChangeLogin.bind(Object(d.a)(n)),n.handleSubmitLogin=n.handleSubmitLogin.bind(Object(d.a)(n)),n.state={loggedIn:!1,email:"",password:"",reason:""},n}return Object(l.a)(s,[{key:"componentDidMount",value:function(){this.setState({loggedIn:JSON.parse(window.sessionStorage.getItem("loggedIn"))})}},{key:"Header",value:function(){var e=this;if(console.log(this.state),this.state.loggedIn){var t={loggedIn:!1,email:"",password:"",userId:""};return Object(O.jsx)("div",{id:"header",children:Object(O.jsxs)("ul",{children:[Object(O.jsx)("li",{children:Object(O.jsx)(_.b,{to:"home",children:Object(O.jsx)("button",{children:"Home"})})}),Object(O.jsx)("li",{children:Object(O.jsx)(_.b,{to:"viewTickets",children:Object(O.jsx)("button",{children:"View Tickets"})})}),Object(O.jsx)("li",{onClick:function(){e.setState(t),window.sessionStorage.setItem("loggedIn",!1),window.sessionStorage.removeItem("ticketsCreated"),window.sessionStorage.removeItem("date"),window.sessionStorage.removeItem("seatNumber"),window.sessionStorage.removeItem("forms"),window.sessionStorage.removeItem("busId"),window.sessionStorage.removeItem("totalAmount"),window.location.href="http://localhost:3000/home"},children:Object(O.jsx)("button",{children:"Logout"})})]})})}return Object(O.jsx)("div",{id:"header",children:Object(O.jsxs)("ul",{children:[Object(O.jsx)("li",{children:Object(O.jsx)(_.b,{to:"home",children:Object(O.jsx)("button",{children:"Home"})})}),Object(O.jsx)("li",{children:Object(O.jsx)(_.b,{to:"signup",children:Object(O.jsx)("button",{children:"Signup"})})}),Object(O.jsx)("li",{children:Object(O.jsx)(_.b,{to:"login",children:Object(O.jsx)("button",{children:"Login"})})})]})})}},{key:"handleChangeLogin",value:function(e){this.setState(Object(o.a)({},e.target.name,e.target.value))}},{key:"handleSubmitLogin",value:function(e){var t=this;e.preventDefault(),document.getElementById("loginFormButton").disabled=!0;var s=document.getElementById("loginFormButton").style.backgroundColor;document.getElementById("loginFormButton").style.backgroundColor="grey",y.post("http://localhost:5000/api/login",{email:this.state.email,password:this.state.password}).then((function(e){e.data.login?(t.setState({loggedIn:!0}),t.setState({reason:e.data.reason}),window.sessionStorage.setItem("loggedIn",!0),window.sessionStorage.setItem("userId",e.data.userId),setTimeout((function(){window.history.back()}),1e3)):(t.setState({loggedIn:!1}),t.setState({reason:e.data.reason}))})).catch((function(e){console.log(e),t.setState({reason:"Axios error"})})).then((function(){t.state.loggedIn||(document.getElementById("loginFormButton").disabled=!1,document.getElementById("loginFormButton").style.backgroundColor=s)}))}},{key:"Login",value:function(){return this.state.loggedIn?Object(O.jsx)("form",{onSubmit:this.handleSubmitLogin,id:"loginForm",children:Object(O.jsx)("h2",{style:{color:"green"},children:"You are now successfully Logged in!!!"})}):Object(O.jsxs)("form",{onSubmit:this.handleSubmitLogin,id:"loginForm",children:[Object(O.jsx)("h2",{children:"Login to access your data & dont forget to Logout"}),Object(O.jsx)("input",{name:"email",type:"email",onChange:this.handleChangeLogin,placeholder:"Email Id"}),Object(O.jsx)("input",{type:"password",name:"password",onChange:this.handleChangeLogin,placeholder:"Password"}),Object(O.jsx)("button",{id:"loginFormButton",type:"submit",children:" Login "}),Object(O.jsx)("h2",{style:{color:"red"},children:this.state.reason})]})}},{key:"render",value:function(){return Object(O.jsxs)("div",{children:[Object(O.jsx)(this.Header,{}),Object(O.jsxs)(b.c,{children:[Object(O.jsx)(b.a,{exact:!0,path:"/",children:Object(O.jsx)(E,{})}),Object(O.jsx)(b.a,{path:"/home",children:Object(O.jsx)(E,{})}),Object(O.jsx)(b.a,{path:"/plantrip",children:Object(O.jsx)(E,{})}),Object(O.jsx)(b.a,{path:"/selectbus",children:Object(O.jsx)(g,{})}),Object(O.jsx)(b.a,{path:"/selectseats",component:f.a}),Object(O.jsx)(b.a,{path:"/payment",children:Object(O.jsx)(S,{})}),Object(O.jsx)(b.a,{path:"/login",children:Object(O.jsx)(this.Login,{})}),Object(O.jsx)(b.a,{path:"/signup",children:Object(O.jsx)(p,{})}),Object(O.jsx)(b.a,{path:"/viewTickets",children:Object(O.jsx)(C,{})}),Object(O.jsxs)(b.a,{children:[" ",Object(O.jsx)("h2",{children:"Not Available"})," "]})]}),Object(O.jsx)(D,{})]})}}]),s}(a.a.Component);var v=function(){return Object(O.jsx)(_.a,{children:Object(O.jsx)(I,{})})},M=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,66)).then((function(t){var s=t.getCLS,n=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;s(e),n(e),a(e),r(e),i(e)}))};i.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(v,{})}),document.getElementById("root")),M()}},[[65,1,2]]]);
//# sourceMappingURL=main.4a34e1c4.chunk.js.map